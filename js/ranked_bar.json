{
  "$schema": "https://vega.github.io/schema/vega-lite/v5.json",
  "title": "Hazardous CO2 Emissions Per Capita",
  "width": "container",
  "height": 400,

  "layer": [{
    "data": {
      "url": "https://raw.githubusercontent.com/Jbar2022/3179/main/data/CO2_emission.csv"
    },
    "layer": [{
      "transform": [
        {
          "window": [{
            "op": "rank",
            "as": "rank"
          }],
          "sort": [{ "field": "2019", "order": "descending" }]
        }, {
          "filter": "datum.rank <= 25"
        }
      ],
      "mark": "bar",
      "encoding": {
        "x": {"field": "Country Name", "type": "nominal", "axis": {"labelAngle": 270}, "sort": { "field": "2019", "op": "average", "order":"descending"}},
        "y": {"field": "2019", "type": "quantitative"}
      }
    }, {
      "mark": "bar",
      "transform": [
        {
          "window": [{
            "op": "rank",
            "as": "rank"
          }],
          "sort": [{ "field": "2019", "order": "descending" }]
        }, 
        {"filter": "datum.rank <= 25"},
        {"filter": {"field": "2019", "gt": 2.3}},
        {"calculate": "2.31", "as": "baseline"}
      ],
      "encoding": {
        "x": {"field": "Country Name", "type": "nominal", "sort": { "field": "2019", "op": "average", "order":"descending"}},
        "y": {"field": "baseline", "type": "quantitative", "title": "CO2 Emissions Per Capita"},
        "y2": {"field": "2019"},
        "color": {"value": "#e45752"}
      }
    }
  ]}, {
    "data": {
       "values": [{}]
    },
    "encoding": {
      "y": {"datum":2.3}
    },
    "layer": [{
      "mark": "rule"
    }, {
      "mark": {
        "type": "text",
        "align": "right",
        "baseline": "bottom",
        "dx": -2,
        "dy": -2,
        "x": "width",
        "text": "Goal"
      }
    }]
  }
]
}